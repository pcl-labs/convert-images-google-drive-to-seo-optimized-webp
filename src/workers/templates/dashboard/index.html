{% extends "base.html" %}
{% set page_title = 'Dashboard' %}
{% from 'components/layout/page.html' import page_container %}
{% from 'components/dashboard/composer.html' import project_composer %}
{% from 'components/dashboard/project_list.html' import project_row %}
{% from 'components/elements/tabs.html' import tabs as dashboard_tabs %}
{% block content %}
{% call page_container('space-y-8') %}
  {{ project_composer(csrf_token, content_schema_choices, youtube_connected) }}

  <section class="rounded-[32px] bg-surface px-6 py-5 shadow" x-data="{ currentTab: '{{ project_tab }}' }">
    {{ dashboard_tabs('currentTab', [
      {"value": "projects", "label": "Projects"},
      {"value": "archive", "label": "Archive"},
    ]) }}
    <div class="py-4">
      <div x-cloak x-show="currentTab === 'projects'" id="panel-projects" role="tabpanel" aria-labelledby="tab-projects">
        {% if projects_active %}
          <div class="space-y-2">
            {% for project in projects_active %}
              {{ project_row(project) }}
            {% endfor %}
          </div>
        {% else %}
          <div class="rounded-2xl border border-dashed border-border p-8 text-center text-sm text-contentMuted">
            No projects yet. Create one from the composer above.
          </div>
        {% endif %}
      </div>
      <div x-cloak x-show="currentTab === 'archive'" id="panel-archive" role="tabpanel" aria-labelledby="tab-archive">
        {% if projects_archive %}
          <div class="space-y-2">
            {% for project in projects_archive %}
              {{ project_row(project) }}
            {% endfor %}
          </div>
        {% else %}
          <div class="rounded-2xl border border-dashed border-border p-8 text-center text-sm text-contentMuted">
            Archive is empty. Completed projects will land here automatically.
          </div>
        {% endif %}
      </div>
    </div>
  </section>
{% endcall %}
{% endblock %}

{% block scripts %}
  {% include 'components/scripts/project_composer.html' %}
{% endblock %}
