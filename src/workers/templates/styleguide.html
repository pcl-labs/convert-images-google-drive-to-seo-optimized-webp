{% extends "base_public.html" %}
{% set title = 'Design System Styleguide' %}
{% block content %}
{# Import all component macros at the top #}
{% from 'components/elements/button.html' import button %}
{% from 'components/elements/card.html' import card %}
{% from 'components/elements/input.html' import input %}
{% from 'components/elements/alert.html' import alert %}
{% from 'components/elements/badge.html' import badge %}
{% from 'components/overlays/modal.html' import modal %}
{% from 'components/elements/dropdown.html' import dropdown %}
{% from 'components/layout/page.html' import page_container, page_header %}

{% call page_container(class='space-y-12') %}
  {{ page_header('Design System Styleguide', 'Visual reference for all components and design tokens') }}

  <!-- Design Tokens -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Design Tokens</h2>
    {% call card(title='Colors') %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div>
          <div class="text-sm font-medium text-contentMuted mb-2">Backgrounds</div>
          <div class="space-y-2">
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-bg border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">bg</div>
                <div class="text-xs text-contentMuted font-mono">--bg</div>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-surface border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">surface</div>
                <div class="text-xs text-contentMuted font-mono">--surface</div>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-surfaceMuted border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">surface-muted</div>
                <div class="text-xs text-contentMuted font-mono">--surface-muted</div>
              </div>
            </div>
          </div>
        </div>
        <div>
          <div class="text-sm font-medium text-contentMuted mb-2">Text</div>
          <div class="space-y-2">
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-surfaceMuted border border-border flex items-center justify-center">
                <span class="text-content">Aa</span>
              </div>
              <div>
                <div class="text-sm text-content font-medium">content</div>
                <div class="text-xs text-contentMuted font-mono">--content</div>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-surfaceMuted border border-border flex items-center justify-center">
                <span class="text-contentMuted">Aa</span>
              </div>
              <div>
                <div class="text-sm text-content font-medium">content-muted</div>
                <div class="text-xs text-contentMuted font-mono">--content-muted</div>
              </div>
            </div>
          </div>
        </div>
        <div>
          <div class="text-sm font-medium text-contentMuted mb-2">Brand</div>
          <div class="space-y-2">
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-primary border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">primary</div>
                <div class="text-xs text-contentMuted font-mono">--primary</div>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-destructive border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">destructive</div>
                <div class="text-xs text-contentMuted font-mono">--destructive</div>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-accent border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">accent</div>
                <div class="text-xs text-contentMuted font-mono">--accent</div>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-16 h-16 rounded-md bg-warning border border-border"></div>
              <div>
                <div class="text-sm text-content font-medium">warning</div>
                <div class="text-xs text-contentMuted font-mono">--warning</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endcall %}
  </section>

  <!-- Buttons -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Buttons</h2>
    {% call card(title='Button Variants') %}
      <div class="space-y-4">
        <div>
          <div class="text-sm text-contentMuted mb-2">All Variants</div>
          <div class="flex flex-wrap items-center gap-3">
            {{ button('Primary', variant='primary') }}
            {{ button('Secondary', variant='secondary') }}
            {{ button('Destructive', variant='destructive') }}
            {{ button('Ghost', variant='ghost') }}
          </div>
        </div>
        <div>
          <div class="text-sm text-contentMuted mb-2">With Spinner</div>
          <div class="flex flex-wrap items-center gap-3">
            {{ button('Loading...', variant='primary', with_spinner=True) }}
            {{ button('Processing', variant='secondary', with_spinner=True) }}
          </div>
        </div>
        <div>
          <div class="text-sm text-contentMuted mb-2">Disabled States</div>
          <div class="flex flex-wrap items-center gap-3">
            {{ button('Disabled Primary', variant='primary', attrs='disabled') }}
            {{ button('Disabled Secondary', variant='secondary', attrs='disabled') }}
          </div>
        </div>
      </div>
    {% endcall %}
  </section>

  <!-- Cards -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Cards</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {% call card(title='Card with Title') %}
        <p class="text-content">This is a card with a title. It uses the <code class="text-primary font-mono text-sm">.surface</code> class for styling.</p>
      {% endcall %}
      {% call card() %}
        <p class="text-content">This is a card without a title. Still uses the same surface styling.</p>
      {% endcall %}
    </div>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="surface-muted rounded-xl p-4">
        <div class="text-contentMuted text-sm">Surface Muted</div>
        <div class="mt-2 text-2xl font-semibold text-content">Example</div>
      </div>
      <div class="surface-muted rounded-xl p-4">
        <div class="text-contentMuted text-sm">Surface Muted</div>
        <div class="mt-2 text-2xl font-semibold text-content">Example</div>
      </div>
      <div class="surface-muted rounded-xl p-4">
        <div class="text-contentMuted text-sm">Surface Muted</div>
        <div class="mt-2 text-2xl font-semibold text-content">Example</div>
      </div>
    </div>
  </section>

  <!-- Inputs -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Input Fields</h2>
    {% call card(title='Input Variants') %}
      <div class="space-y-4">
        {{ input('text_input', label='Text Input', placeholder='Enter text...') }}
        {{ input('email_input', label='Email Input', type='email', placeholder='user@example.com') }}
        {{ input('password_input', label='Password Input', type='password', placeholder='Enter password') }}
        {{ input('error_input', label='Input with Error', placeholder='This has an error', error='This field is required') }}
        <div class="space-y-1">
          <label for="textarea_example" class="block text-sm font-medium text-contentMuted">Textarea</label>
          <textarea id="textarea_example" name="textarea_example" rows="4" class="field w-full" placeholder="Enter multiple lines of text..."></textarea>
        </div>
        <div class="space-y-1">
          <label for="disabled_input" class="block text-sm font-medium text-contentMuted">Disabled Input</label>
          <input id="disabled_input" name="disabled_input" type="text" placeholder="Disabled" class="field w-full" disabled>
        </div>
      </div>
    {% endcall %}
  </section>

  <!-- Alerts -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Alerts</h2>
    {% call card(title='Alert Variants') %}
      <div class="space-y-3">
        {{ alert('info', 'This is an info alert message.') }}
        {{ alert('success', 'This is a success alert message.') }}
        {{ alert('error', 'This is an error alert message.') }}
        {{ alert('info', 'This alert is not dismissible.', dismissible=False) }}
      </div>
    {% endcall %}
  </section>

  <!-- Badges -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Badges</h2>
    {% call card(title='Badge Status Variants') %}
      <div class="flex flex-wrap items-center gap-3">
        {{ badge('Running', status='running') }}
        {{ badge('Queued', status='queued') }}
        {{ badge('Completed', status='completed') }}
        {{ badge('Failed', status='failed') }}
        {{ badge('Disconnected', status='disconnected') }}
        {{ badge('Default', status='default') }}
      </div>
    {% endcall %}
  </section>

  <!-- Data Lists -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Data Lists</h2>
    {% call card(title='Responsive Cards') %}
      <div class="space-y-3">
        {% for item in [
          {'name': 'Example Item 1', 'status': 'running', 'created': '2024-01-15'},
          {'name': 'Example Item 2', 'status': 'queued', 'created': '2024-01-14'},
          {'name': 'Example Item 3', 'status': 'failed', 'created': '2024-01-13'}
        ] %}
          <article class="surface rounded-lg p-4 space-y-2">
            <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
              <div class="text-sm font-semibold text-content">{{ item.name }}</div>
              <div>{{ badge(item.status|title, status=item.status) }}</div>
            </div>
            <p class="text-xs text-contentMuted">Created {{ item.created }}</p>
          </article>
        {% endfor %}
      </div>
    {% endcall %}
  </section>

  <!-- Modals -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Modals</h2>
    {% call card(title='Modal Examples') %}
      <div class="space-y-3">
        <p class="text-contentMuted text-sm">Click the buttons below to open modals:</p>
        <div class="flex flex-wrap items-center gap-3">
          {{ button('Open Confirmation Modal', variant='primary', attrs='@click="$dispatch(\'open-example-modal\')"') }}
          {{ button('Open Delete Modal', variant='destructive', attrs='@click="$dispatch(\'open-delete-modal\')"') }}
        </div>
      </div>
    {% endcall %}
    {% call modal('example-modal', title='Example Modal', confirm_text='Confirm', cancel_text='Cancel') %}
      <p class="text-content text-sm">This is an example modal. You can customize the title, confirm text, and cancel text.</p>
    {% endcall %}
    {% call modal('delete-modal', title='Delete Item', confirm_text='Delete', cancel_text='Cancel') %}
      <p class="text-content text-sm">Are you sure you want to delete this item? This action cannot be undone.</p>
    {% endcall %}
  </section>

  <!-- Dropdowns -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Dropdowns</h2>
    {% call card(title='Dropdown Examples') %}
      <div class="space-y-4">
        {% set trigger_left %}
          <button @click="toggle()" @keydown.escape="close()" class="inline-flex items-center gap-2 rounded-md bg-surfaceMuted/80 border border-border px-3 py-2 text-sm text-content hover:bg-surfaceMuted">
            <span>Select Option</span>
            <svg class="h-4 w-4 text-contentMuted" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.17l3.71-3.94a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>
          </button>
        {% endset %}
        {% call dropdown(trigger_left, align='left', width='sm') %}
          <nav class="py-1 text-sm" role="menu">
            <a href="#" class="block px-3 py-2 text-content hover:bg-surfaceMuted/60" role="menuitem">Option 1</a>
            <a href="#" class="block px-3 py-2 text-content hover:bg-surfaceMuted/60" role="menuitem">Option 2</a>
            <a href="#" class="block px-3 py-2 text-content hover:bg-surfaceMuted/60" role="menuitem">Option 3</a>
          </nav>
        {% endcall %}
      </div>
    {% endcall %}
  </section>

  <!-- Component API Documentation -->
  <section class="space-y-4">
    <h2 class="text-2xl font-semibold text-content">Component API Reference</h2>
    {% call card(title='Button Component') %}
      <div class="space-y-4 text-sm">
        <div>
          <div class="text-content font-semibold mb-2">Macro: <code class="text-primary font-mono">button</code></div>
          <div class="text-contentMuted mb-2">Location: <code class="font-mono">src/workers/templates/components/elements/button.html</code></div>
          <div class="space-y-2">
            <div><span class="text-content font-medium">Parameters:</span></div>
            <ul class="list-disc list-inside space-y-1 text-contentMuted ml-4">
              <li><code class="text-primary">label</code> (required): Button text</li>
              <li><code class="text-primary">variant</code> (default: "primary"): One of "primary", "secondary", "destructive", "ghost"</li>
              <li><code class="text-primary">attrs</code> (default: ""): Additional HTML attributes (e.g., 'type="submit"', '@click="..."')</li>
              <li><code class="text-primary">with_spinner</code> (default: False): Show loading spinner</li>
              <li><code class="text-primary">spinner_id</code> (optional): ID for the spinner element</li>
              <li><code class="text-primary">extra_classes</code> (default: ""): Additional CSS classes</li>
            </ul>
          </div>
          <div class="mt-3">
            <div class="text-content font-medium mb-2">Example:</div>
            <pre class="bg-surfaceMuted p-3 rounded-md text-xs text-contentMuted font-mono overflow-x-auto"><code>{{ button('Click Me', variant='primary', attrs='type="submit"') }}</code></pre>
          </div>
        </div>
      </div>
    {% endcall %}

    {% call card(title='Card Component') %}
      <div class="space-y-4 text-sm">
        <div>
          <div class="text-content font-semibold mb-2">Macro: <code class="text-primary font-mono">card</code></div>
          <div class="text-contentMuted mb-2">Location: <code class="font-mono">src/workers/templates/components/elements/card.html</code></div>
          <div class="space-y-2">
            <div><span class="text-content font-medium">Parameters:</span></div>
            <ul class="list-disc list-inside space-y-1 text-contentMuted ml-4">
              <li><code class="text-primary">title</code> (optional): Card header title</li>
              <li><code class="text-primary">actions</code> (optional): HTML for action buttons/links in header</li>
            </ul>
          </div>
          <div class="mt-3">
            <div class="text-content font-medium mb-2">Usage:</div>
            <pre class="bg-surfaceMuted p-3 rounded-md text-xs text-contentMuted font-mono overflow-x-auto"><code>{% raw %}{% call card(title='My Card') %}
  <p>Card content here</p>
{% endcall %}{% endraw %}</code></pre>
          </div>
        </div>
      </div>
    {% endcall %}

    {% call card(title='Input Component') %}
      <div class="space-y-4 text-sm">
        <div>
          <div class="text-content font-semibold mb-2">Macro: <code class="text-primary font-mono">input</code></div>
          <div class="text-contentMuted mb-2">Location: <code class="font-mono">src/workers/templates/components/elements/input.html</code></div>
          <div class="space-y-2">
            <div><span class="text-content font-medium">Parameters:</span></div>
            <ul class="list-disc list-inside space-y-1 text-contentMuted ml-4">
              <li><code class="text-primary">name</code> (required): Input name attribute</li>
              <li><code class="text-primary">label</code> (optional): Label text</li>
              <li><code class="text-primary">type</code> (default: "text"): Input type</li>
              <li><code class="text-primary">value</code> (default: ""): Input value</li>
              <li><code class="text-primary">placeholder</code> (default: ""): Placeholder text</li>
              <li><code class="text-primary">error</code> (optional): Error message to display</li>
              <li><code class="text-primary">attrs</code> (default: ""): Additional HTML attributes</li>
            </ul>
          </div>
        </div>
      </div>
    {% endcall %}

    {% call card(title='Alert Component') %}
      <div class="space-y-4 text-sm">
        <div>
          <div class="text-content font-semibold mb-2">Macro: <code class="text-primary font-mono">alert</code></div>
          <div class="text-contentMuted mb-2">Location: <code class="font-mono">src/workers/templates/components/elements/alert.html</code></div>
          <div class="space-y-2">
            <div><span class="text-content font-medium">Parameters:</span></div>
            <ul class="list-disc list-inside space-y-1 text-contentMuted ml-4">
              <li><code class="text-primary">kind</code> (default: "info"): One of "info", "success", "error"</li>
              <li><code class="text-primary">text</code> (default: ""): Alert message (supports HTML)</li>
              <li><code class="text-primary">dismissible</code> (default: True): Show close button</li>
            </ul>
          </div>
        </div>
      </div>
    {% endcall %}

    {% call card(title='Badge Component') %}
      <div class="space-y-4 text-sm">
        <div>
          <div class="text-content font-semibold mb-2">Macro: <code class="text-primary font-mono">badge</code></div>
          <div class="text-contentMuted mb-2">Location: <code class="font-mono">src/workers/templates/components/elements/badge.html</code></div>
          <div class="space-y-2">
            <div><span class="text-content font-medium">Parameters:</span></div>
            <ul class="list-disc list-inside space-y-1 text-contentMuted ml-4">
              <li><code class="text-primary">text</code> (required): Badge text</li>
              <li><code class="text-primary">status</code> (default: "default"): One of "running", "queued", "completed", "failed", "disconnected", "default"</li>
            </ul>
          </div>
        </div>
      </div>
    {% endcall %}

    {% call card(title='Modal Component') %}
      <div class="space-y-4 text-sm">
        <div>
          <div class="text-content font-semibold mb-2">Macro: <code class="text-primary font-mono">modal</code></div>
          <div class="text-contentMuted mb-2">Location: <code class="font-mono">src/workers/templates/components/overlays/modal.html</code></div>
          <div class="space-y-2">
            <div><span class="text-content font-medium">Parameters:</span></div>
            <ul class="list-disc list-inside space-y-1 text-contentMuted ml-4">
              <li><code class="text-primary">id</code> (required): Unique modal ID</li>
              <li><code class="text-primary">title</code> (default: "Confirm"): Modal title</li>
              <li><code class="text-primary">confirm_text</code> (default: "Confirm"): Confirm button text</li>
              <li><code class="text-primary">cancel_text</code> (default: "Cancel"): Cancel button text</li>
            </ul>
            <div class="mt-3">
              <div class="text-content font-medium mb-2">Usage:</div>
              <pre class="bg-surfaceMuted p-3 rounded-md text-xs text-contentMuted font-mono overflow-x-auto"><code>{% raw %}{% call modal('my-modal', title='Delete Item', confirm_text='Delete') %}
  <p>Are you sure?</p>
{% endcall %}{% endraw %}</code></pre>
              <div class="text-contentMuted text-xs mt-2">Open with: <code class="text-primary">@click="$dispatch('open-my-modal')"</code></div>
            </div>
          </div>
        </div>
      </div>
    {% endcall %}
  </section>
{% endcall %}
{% endblock %}

