{% extends "base.html" %}
{% set page_title = 'Activity' %}
{% block content %}
<div class="p-4 md:p-6 space-y-6">
  <div class="space-y-1">
    <h1 class="text-xl font-semibold text-white">Activity</h1>
    <p class="text-sm text-slate-400">Recent notifications</p>
  </div>

  <div class="space-y-2">
    {% from 'components/elements/alert.html' import alert %}
    {% from 'components/elements/button.html' import button %}
    {% if notifications and notifications|length > 0 %}
      {% for n in notifications %}
        {% set level = n.level or 'info' %}
        <div class="flex items-start justify-between gap-3">
          <div class="flex-1">
            {{ alert('success' if level=='success' else ('error' if level=='error' else 'info'), n.text) }}
          </div>
          <div class="flex items-center gap-2">
            {{ button('Seen', variant='ghost', attrs='hx-post="/api/notifications/' ~ n.id ~ '/seen" hx-headers=\'{"X-CSRF-Token":"{{ csrf_token }}"}\' hx-swap="none" hx-on:htmx:afterOnLoad="window.dispatchEvent(new CustomEvent(\'toast\',{detail:{type:\'info\',text:\'Marked seen\'}}))"', with_spinner=True) }}
            {{ button('Dismiss', variant='ghost', attrs='hx-post="/api/notifications/' ~ n.id ~ '/dismiss" hx-headers=\'{"X-CSRF-Token":"{{ csrf_token }}"}\' hx-swap="none" hx-on:htmx:afterOnLoad="window.dispatchEvent(new CustomEvent(\'toast\',{detail:{type:\'info\',text:\'Dismissed\'}}))"', with_spinner=True) }}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="text-slate-400 text-sm">No notifications yet.</div>
    {% endif %}
  </div>
</div>
{% endblock %}
