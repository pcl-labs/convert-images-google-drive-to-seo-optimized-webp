<div id="jobs-list" class="space-y-3">
  {% from 'components/elements/button.html' import button %}
  {% from 'components/elements/badge.html' import badge %}
  {% for job in jobs %}
    <article class="surface rounded-lg p-4 space-y-3">
      <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
        <div class="space-y-1">
          <p class="font-mono text-xs text-contentMuted break-words">{{ job.id }}</p>
          <p class="text-sm font-semibold text-content">{{ job.kind }}</p>
          <p class="text-xs text-contentMuted">Created {{ job.created_at }}</p>
          <div class="flex flex-wrap gap-3 text-[11px] text-contentMuted">
            <a href="/v1/jobs/{{ job.id }}" target="_blank" rel="noopener" class="text-primary hover:text-primary/80">Job API</a>
            <a href="/api/pipelines/stream?job_id={{ job.id }}" target="_blank" rel="noopener" class="text-primary hover:text-primary/80">Stream</a>
            {% if job.document_id %}
              <a href="/v1/documents/{{ job.document_id }}" target="_blank" rel="noopener" class="text-primary hover:text-primary/80">Document API</a>
            {% endif %}
          </div>
        </div>
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center">
          {{ badge(job.status_label, status=job.status) }}
          <a href="/dashboard/jobs/{{ job.id }}" class="text-sm text-primary hover:text-primary/80">View</a>
        </div>
      </div>
      <div class="grid gap-3 text-sm text-contentMuted sm:grid-cols-2">
        <div class="space-y-1">
          <p class="text-xs uppercase tracking-wide">Document</p>
          <p class="font-mono break-all">{{ job.document_id or 'â€”' }}</p>
        </div>
        <div class="space-y-1">
          <p class="text-xs uppercase tracking-wide">Status</p>
          <p>{{ job.status_label }}</p>
        </div>
      </div>
      <div class="flex flex-col gap-2 sm:flex-row sm:justify-end">
        {{ button(
          'Retry',
          variant='ghost',
          with_spinner=True,
          extra_classes='text-contentMuted hover:text-content w-full sm:w-auto',
          attrs='hx-post="/dashboard/jobs/' ~ job.id ~ '/retry" hx-headers="{&quot;X-CSRF-Token&quot;:&quot;{{ csrf_token }}&quot;}" hx-swap="none" hx-on:htmx:afterOnLoad="window.dispatchEvent(new CustomEvent(\'toast\',{detail:{type:\'success\',text:\'Job retried\'}}))" hx-on:htmx:responseError="window.dispatchEvent(new CustomEvent(\'toast\',{detail:{type:\'error\',text:\'Retry failed\'}}))"'
        ) }}
        {{ button(
          'Cancel',
          variant='ghost',
          with_spinner=True,
          extra_classes='text-destructive hover:text-destructive/80 w-full sm:w-auto',
          attrs='hx-delete="/dashboard/jobs/' ~ job.id ~ '" hx-headers="{&quot;X-CSRF-Token&quot;:&quot;{{ csrf_token }}&quot;}" hx-swap="none" hx-on:htmx:afterOnLoad="window.dispatchEvent(new CustomEvent(\'toast\',{detail:{type:\'success\',text:\'Job cancelled\'}}))" hx-on:htmx:responseError="window.dispatchEvent(new CustomEvent(\'toast\',{detail:{type:\'error\',text:\'Cancel failed\'}}))"'
        ) }}
      </div>
    </article>
  {% else %}
    <div class="surface rounded-lg p-6 text-center text-sm text-contentMuted">No jobs found</div>
  {% endfor %}
</div>
