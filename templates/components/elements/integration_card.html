{% macro integration_card(s, data, csrf_token) %}
  {% from 'components/elements/integration_icon.html' import integration_icon %}
  <div class="surface rounded-md px-4 py-4 transition-colors hover:bg-surfaceMuted/50">
    <div class="flex items-start justify-between gap-4">
      <div class="flex items-start gap-3 min-w-0">
        <div class="h-11 w-11 rounded-md bg-surfaceMuted border border-border shrink-0 p-2.5">
          {{ integration_icon(s.key) }}
        </div>
        <a href="/dashboard/integrations/{{ s.key }}" class="min-w-0 group">
          <div class="text-content font-semibold truncate group-hover:underline">{{ s.name }}</div>
          <div class="text-sm text-contentMuted leading-relaxed line-clamp-2">{{ s.subtitle or s.description }}</div>
        </a>
      </div>
      <div class="flex items-center gap-2 shrink-0">
        {% from 'components/elements/button.html' import button %}
        {% if data and data.connected %}
          {% if s.key == 'drive' %}
            <div x-data="{ submit(){ $refs.form && $refs.form.submit() } }" @open-drive-disconnect.window="submit()">
              <form x-ref="form" method="post" action="/dashboard/integrations/drive/disconnect">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
                {{ button('Disconnect', variant='destructive', attrs='type="button" @click="$dispatch(\'open-drive-disconnect\')"') }}
              </form>
            </div>
          {% else %}
            {{ button('Connected', variant='secondary', attrs='disabled', extra_classes='opacity-60 cursor-not-allowed') }}
          {% endif %}
        {% else %}
          {% if s.key == 'drive' %}
            <a href="/auth/google/start" class="btn-primary">Connect</a>
          {% else %}
            {{ button('In roadmap', variant='secondary', attrs='disabled', extra_classes='opacity-60 cursor-not-allowed') }}
          {% endif %}
        {% endif %}
      </div>
    </div>
  </div>
{% endmacro %}
