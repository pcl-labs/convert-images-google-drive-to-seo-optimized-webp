{% from 'components/elements/card.html' import card %}
{% set overview = drive_sync_overview %}
{% set actions = '<a href="' ~ overview.detail_url ~ '" class="text-sm text-primary hover:text-primary/80">Manage integration</a>' %}
{% call card(title='Google Drive workspace sync', actions=actions) %}
  <div class="space-y-4">
    <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
      <div>
        <p class="text-sm font-semibold text-content">{{ overview.status_label }}</p>
        <p class="text-xs text-contentMuted">
          {% if overview.last_synced_at %}
            Last synced {{ overview.last_synced_at }}
          {% else %}
            Connect Google Drive to create your Quill workspace.
          {% endif %}
        </p>
      </div>
      <div class="text-right">
        <p class="text-2xl font-semibold text-content">{{ overview.document_count }}</p>
        <p class="text-xs text-contentMuted">Drive-backed documents</p>
      </div>
    </div>
    {% if overview.folders %}
      <div class="grid gap-3 md:grid-cols-3">
        {% for folder in overview.folders %}
          <div class="rounded-lg border border-border p-3 bg-surface/40">
            <p class="text-xs uppercase tracking-wide text-contentMuted">{{ folder.label }}</p>
            <p class="text-sm font-semibold text-content mt-1">{{ folder.path }}</p>
            <p class="text-xs text-contentMuted mt-1">{{ folder.description }}</p>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% if overview.linked_file %}
      <div class="rounded-lg border border-dashed border-border p-4 bg-surface/20">
        <p class="text-xs uppercase tracking-wide text-contentMuted">Linked Drive file</p>
        <div class="mt-2 text-sm text-content font-semibold">
          {{ overview.linked_file.title or 'Untitled Drive doc' }}
        </div>
        <dl class="mt-3 grid gap-2 text-xs text-contentMuted sm:grid-cols-2">
          <div>
            <dt class="uppercase tracking-wide">File ID</dt>
            <dd class="font-mono text-[11px] text-content">{{ overview.linked_file.file_id or '—' }}</dd>
          </div>
          <div>
            <dt class="uppercase tracking-wide">Revision</dt>
            <dd class="font-mono text-[11px] text-content">{{ overview.linked_file.revision_id or '—' }}</dd>
          </div>
        </dl>
        {% if overview.linked_file.link %}
          <a href="{{ overview.linked_file.link }}" class="mt-3 inline-flex items-center text-xs text-primary hover:text-primary/80" target="_blank" rel="noopener">Open in Drive</a>
        {% endif %}
      </div>
    {% endif %}
  </div>
{% endcall %}
