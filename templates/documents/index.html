{% extends "base.html" %}
{% set page_title = 'Documents' %}
{% block content %}
<div class="p-4 md:p-6 space-y-6">
  <div class="space-y-1">
    <h1 class="text-xl font-semibold text-white">Documents</h1>
    <p class="text-sm text-slate-400">Register sources and ingest content into document IDs.</p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="bg-slate-900/60 border border-slate-800 rounded-xl p-4 space-y-3">
      <div class="flex items-center justify-between">
        <div>
          <div class="text-white font-semibold text-sm">Link Drive Folder</div>
          <p class="text-xs text-slate-400">Requires Google integration</p>
        </div>
        {% if google_connected %}
          <span class="text-xs text-emerald-400 bg-emerald-500/10 border border-emerald-400/30 rounded-md px-2 py-1">Connected</span>
        {% else %}
          <a href="/auth/google/start" class="text-xs text-sky-400 hover:text-sky-300">Connect Google</a>
        {% endif %}
      </div>
      <form class="space-y-3" hx-post="/dashboard/documents/drive" hx-target="#documents-table" hx-swap="outerHTML">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
        <label class="block space-y-1">
          <span class="text-sm text-slate-300">Drive folder link or ID</span>
          <input name="drive_source" type="text" placeholder="https://drive.google.com/drive/folders/..." class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500" {% if not google_connected %}disabled{% endif %} required>
        </label>
        <button type="submit" class="inline-flex items-center justify-center w-full rounded-lg bg-sky-600 hover:bg-sky-500 text-white px-3 py-2 text-sm font-medium" {% if not google_connected %}disabled{% endif %}>
          Register Document
        </button>
      </form>
    </div>

    <div class="bg-slate-900/60 border border-slate-800 rounded-xl p-4 space-y-3">
      <div class="text-white font-semibold text-sm">Ingest YouTube Video</div>
      <form class="space-y-3" hx-post="/dashboard/documents/youtube" hx-target="#documents-table" hx-swap="outerHTML">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
        <label class="block space-y-1">
          <span class="text-sm text-slate-300">YouTube URL</span>
          <input name="youtube_url" type="url" placeholder="https://www.youtube.com/watch?v=..." class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500" required>
        </label>
        <button type="submit" class="inline-flex items-center justify-center w-full rounded-lg bg-violet-600 hover:bg-violet-500 text-white px-3 py-2 text-sm font-medium">
          Queue Transcript &amp; Chapters
        </button>
      </form>
    </div>

    <div class="bg-slate-900/60 border border-slate-800 rounded-xl p-4 space-y-3">
      <div class="text-white font-semibold text-sm">Paste Raw Text</div>
      <form class="space-y-3" hx-post="/dashboard/documents/text" hx-target="#documents-table" hx-swap="outerHTML">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
        <label class="block space-y-1">
          <span class="text-sm text-slate-300">Title (optional)</span>
          <input name="title" type="text" placeholder="My interview notes" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500">
        </label>
        <label class="block space-y-1">
          <span class="text-sm text-slate-300">Text</span>
          <textarea name="text_body" rows="5" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500" placeholder="Paste article, transcript, or outline..." required></textarea>
        </label>
        <button type="submit" class="inline-flex items-center justify-center w-full rounded-lg bg-emerald-600 hover:bg-emerald-500 text-white px-3 py-2 text-sm font-medium">
          Create Document
        </button>
      </form>
    </div>
  </div>

  <div class="bg-slate-900/60 border border-slate-800 rounded-xl">
    <div class="px-4 py-3 border-b border-slate-800 flex items-center justify-between">
      <div>
        <div class="font-semibold text-white">All Documents</div>
        <p class="text-xs text-slate-500">{{ total_documents }} total</p>
      </div>
      <div class="text-xs text-slate-400">Use Document IDs when scheduling optimization or blog generation jobs.</div>
    </div>
    {% include "documents/partials/list.html" %}
  </div>
</div>
{% endblock %}
